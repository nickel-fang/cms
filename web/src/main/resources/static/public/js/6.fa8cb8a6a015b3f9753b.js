webpackJsonp([6],{"0Al2":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,n=E(a("Dd8w")),r=E(a("vgHw")),i=E(a("8Uiw")),u=E(a("1cZb")),o=E(a("Zx67")),d=E(a("Zrlr")),s=E(a("wxAW")),c=E(a("zwoO")),f=E(a("Pf15")),p=E(a("rpsp")),m=E(a("Q7hp"));a("ZJow"),a("dcJ6"),a("YaoS"),a("Nmhe");var h=a("GiK3"),v=E(h),g=a("Mn8c"),b=(E(a("KSGD")),a("LkMq")),k=E(a("lbHh"));function E(e){return e&&e.__esModule?e:{default:e}}var y=p.default.Dragger,C=(0,g.inject)("app")(l=(0,g.observer)(l=function(e){function t(e){(0,d.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return a.onUploaderChange=function(e){var t=a.props.saveFileName,l=e.file.status;"uploading"===l&&a.setState({uploadFileList:e.fileList}),"done"===l?(u.default.success(e.file.name+" 上传成功"),t(e.file.response.data)):"error"===l&&u.default.error(e.file.name+" 上传失败")},a.state={uploadFileList:[]},a}return(0,f.default)(t,e),(0,s.default)(t,[{key:"componentWillReceiveProps",value:function(){this.props.visible||this.setState({uploadFileList:[]})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.app.selectSiteId,l=this.state.uploadFileList.map(function(e,t){return v.default.createElement("div",{className:"progressWarp",key:e.uid+t},"上传文件“",e.name,"” ",v.default.createElement(i.default,{percent:e.percent}))}),u={name:"file",headers:{},multiple:!0,showUploadList:!1,action:"/api/templates/files?siteId="+a},o=(0,m.default)(k.default.getJSON(b.CACHE_GLOBAL),"token");return o&&(u.headers.Authorization=o),v.default.createElement("div",null,t?v.default.createElement("div",null,v.default.createElement(y,(0,n.default)({},u,{onChange:this.onUploaderChange}),v.default.createElement("p",{className:"ant-upload-drag-icon"},v.default.createElement(r.default,{type:"inbox"})),v.default.createElement("p",{className:"ant-upload-text"},"点击或拖拽到此区域上传"),v.default.createElement("p",{className:"ant-upload-hint"},"支持单个或多个文件")),l):null)}}]),t}(h.Component))||l)||l;t.default=C},"9Zdi":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,n,r,i=T(a("mvHQ")),u=T(a("1cZb")),o=T(a("IidI")),d=T(a("vaID")),s=T(a("Dd8w")),c=T(a("Zx67")),f=T(a("Zrlr")),p=T(a("wxAW")),m=T(a("zwoO")),h=T(a("Pf15")),v=T(a("uuhB")),g=T(a("37+n")),b=T(a("NJOH"));a("YaoS"),a("1uA9"),a("nclB"),a("TZP0"),a("8QNH"),a("mKHw");var k=a("GiK3"),E=T(k),y=a("F8kA"),C=a("Mn8c"),S=a("y986"),w=T(a("mw3O")),I=(T(a("+/rg")),T(a("VqBH"))),_=T(a("PGoZ")),x=T(a("0Al2"));function T(e){return e&&e.__esModule?e:{default:e}}a("clk9");var N=b.default.Option,F=g.default.Item,L=v.default.TextArea,P=(0,C.inject)("app")(l=(0,C.inject)("template")(l=(0,C.observer)((n=function(e){function t(e){(0,f.default)(this,t);var a=(0,m.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e));r.call(a);var l=e.location.search,n=e.app,i=n.selectSiteId,u=(n.sites,e.template),o=u.getItem,d=u.getTemplateList,s=u.updateStore;a.state={visible:!1},a.selectSiteId=i,d({siteId:i});var p=w.default.parse(l.substr(1));return p.id?o(p.id):s({curItem:{}}),a}return(0,h.default)(t,e),(0,p.default)(t,[{key:"componentWillReact",value:function(){var e=this.props,t=e.app,a=t.selectSiteId,l=(t.sites,e.template);this.selectSiteId!=a&&l.getTemplateList({siteId:a}),this.selectSiteId=a}},{key:"componentWillUnmount",value:function(){this.props.template.reset()}},{key:"render",value:function(){var e=this,t=this.props,a=t.form.getFieldDecorator,l=t.app.selectSiteId,n=t.template,r=n.curItem,i=n.allFileList,u=n.addedFileList,c=n.updateStore,f=n.selectedType,p=(0,S.toJS)(i),m=(0,S.toJS)(r),h={visible:this.state.visible,onOk:function(){p=(0,s.default)({},p,u),c({allFileList:p,addedFileList:{}}),e.setState({visible:!1})},onCancel:function(){e.setState({visible:!1})}},k={allFileList:p,deleteFile:this.deleteFile,handleModal:this.handleModal},y={visible:this.state.visible,saveFileName:this.saveFileName};return E.default.createElement("div",{className:"template-edit"},E.default.createElement(d.default,h,E.default.createElement(x.default,y)),E.default.createElement(g.default,null,E.default.createElement(F,(0,s.default)({label:"模版类型"},{labelCol:{span:5},wrapperCol:{span:18}}),a("type",{initialValue:m.type||"",rules:[{required:!0,message:"请选择类型"}]})(E.default.createElement(b.default,{onChange:this.handleChange},E.default.createElement(N,{key:"category",value:"category"},"频道模版"),E.default.createElement(N,{key:"block",value:"block"},"区块模版"),E.default.createElement(N,{key:"detail",value:"detail"},"详情模版")))),E.default.createElement(F,(0,s.default)({label:"模版名称"},{labelCol:{span:5},wrapperCol:{span:18}}),a("name",{initialValue:m.name||"",rules:[{required:!0,message:"请输入模版名称",type:"string"},{validator:function(e,t,a){t.length>20?a("模版名称超出"+(t.length-20)+"个字符"):a()}}]})(E.default.createElement(v.default,{type:"text"}))),E.default.createElement(F,(0,s.default)({label:"模版内容"},{labelCol:{span:5},wrapperCol:{span:18}}),a("content",{initialValue:m.content||""})(E.default.createElement(L,{rows:10,placeholder:"请输入模版内容"}))),E.default.createElement(F,(0,s.default)({label:"描述"},{labelCol:{span:5},wrapperCol:{span:18}}),a("description",{initialValue:m.description||"",rules:[{type:"string"},{validator:function(e,t,a){t.length>50?a("模版名称超出"+(t.length-50)+"个字符"):a()}}]})(E.default.createElement(v.default,{placeholder:"请输入描述"}))),E.default.createElement(F,(0,s.default)({label:"文件"},{labelCol:{span:5},wrapperCol:{span:18}}),a("resourceJson",{initialValue:m.resourceJson||{}})(E.default.createElement(_.default,k))),"block"==f?null:E.default.createElement(F,null,a("blocks",{initialValue:{blocks:m.blocks}})(E.default.createElement(I.default,{siteId:l})))),E.default.createElement(F,{wrapperCol:{span:6,offset:6}},E.default.createElement(o.default,{style:{marginRight:"20px"},type:"primary",onClick:this.onSave},"保存"),E.default.createElement(o.default,{onClick:this.goBack},"返回")))}}]),t}(k.Component),r=function(){var e=this;this.goBack=function(){var t=e.props,a=t.history;t.template.updateStore;a.goBack()},this.fromBlocks=function(e){var t=e.blocks;return(0,S.toJS)(t)||null},this.onSave=function(){var t=e.props,a=t.location.search,l=t.form,n=l.validateFieldsAndScroll,r=l.resetFields,o=t.app.selectSiteId,d=t.template,c=d.saveItem,f=d.curItem,p=d.allFileList,m=(d.updateStore,d.selectedType),h=(0,S.toJS)(f);n(function(t,l){if(!t){l.blocks=e.fromBlocks(l.blocks||{}),"block"==m&&(l.blocks=null);w.default.parse(a.substr(1)).id;var n=(0,s.default)({},h,{siteId:o},l,{resourceJson:(0,i.default)(p)});c(n,function(){var t=function(){r(),e.goBack()};a?u.default.success("保存成功",1,t):u.default.success("添加成功",1,t)})}})},this.handleModal=function(){e.setState({visible:!e.state.visible})},this.saveFileName=function(t){var a=e.props.template,l=a.updateStore,n=a.addedFileList,r=(0,S.toJS)(n);l({addedFileList:r=(0,s.default)({},r,t)})},this.deleteFile=function(t){var a=e.props.template,l=a.allFileList,n=a.updateStore,r=(0,S.toJS)(l);delete r[t],n({allFileList:r})},this.handleChange=function(t){(0,e.props.template.updateStore)({selectedType:t})}},l=n))||l)||l)||l;t.default=(0,y.withRouter)(g.default.create()(P))},Cdx3:function(e,t,a){var l=a("sB3e"),n=a("lktj");a("uqUo")("keys",function(){return function(e){return n(l(e))}})},Kcfq:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=m(a("Zx67")),n=m(a("Zrlr")),r=m(a("wxAW")),i=m(a("zwoO")),u=m(a("Pf15")),o=a("GiK3"),d=m(o),s=a("F8kA"),c=a("LkMq"),f=m(a("rttv")),p=m(a("9Zdi"));function m(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){return(0,n.default)(this,t),(0,i.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e))}return(0,u.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return d.default.createElement("div",{className:"p-common"},d.default.createElement(s.Switch,null,d.default.createElement(s.Route,{exact:!0,path:c.ROUTER_PATHS.TEMPLATE,component:f.default}),d.default.createElement(s.Route,{exact:!0,path:c.ROUTER_PATHS.TEMPLATE_EDIT,component:p.default})))}}]),t}(o.Component);t.default=(0,s.withRouter)(h)},PGoZ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=p(a("vgHw")),n=p(a("fZjL")),r=p(a("BO1k")),i=p(a("IidI")),u=p(a("Zx67")),o=p(a("Zrlr")),d=p(a("wxAW")),s=p(a("zwoO")),c=p(a("Pf15"));a("ZJow"),a("1uA9");var f=p(a("GiK3"));function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,u.default)(t)).call(this,e))}return(0,c.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=this.props,t=e.allFileList,a=e.handleModal,u=e.deleteFile,o=[],d=!0,s=!1,c=void 0;try{for(var p,m=(0,r.default)((0,n.default)(t));!(d=(p=m.next()).done);d=!0){var h=p.value;o.push(f.default.createElement("div",{key:h},f.default.createElement("span",{className:"filename"},h),f.default.createElement("span",{className:"fileurl"},t[h]),f.default.createElement("span",{onClick:u.bind(this,h)},f.default.createElement(l.default,{className:"filename-icon",type:"close"}))))}}catch(e){s=!0,c=e}finally{try{!d&&m.return&&m.return()}finally{if(s)throw c}}return f.default.createElement("div",null,o,f.default.createElement(i.default,{onClick:a},"上传"))}}]),t}(f.default.Component);t.default=m},VqBH:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,n,r,i=I(a("vaID")),u=I(a("yF52")),o=I(a("ExGt")),d=I(a("vgHw")),s=I(a("uuhB")),c=I(a("0b0c")),f=I(a("G3dI")),p=I(a("IidI")),m=I(a("Dd8w")),h=I(a("Zx67")),v=I(a("Zrlr")),g=I(a("wxAW")),b=I(a("zwoO")),k=I(a("Pf15")),E=I(a("VCGi"));a("nclB"),a("tNTX"),a("2r77"),a("ZJow"),a("TZP0"),a("kxBb"),a("/Hhv"),a("1uA9"),a("6opi");var y=a("GiK3"),C=I(y),S=a("Mn8c"),w=a("y986");function I(e){return e&&e.__esModule?e:{default:e}}a("fpag");var _=E.default.Panel,x=(0,S.inject)("template")(l=(0,S.observer)((n=function(e){function t(e){(0,v.default)(this,t);var a=(0,b.default)(this,(t.__proto__||(0,h.default)(t)).call(this,e));r.call(a);var l=a.props.value,n=void 0===l?{}:l;return a.state={blocks:n.blocks||[],currentBlkIndex:null},a}return(0,k.default)(t,e),(0,g.default)(t,[{key:"componentWillReceiveProps",value:function(e){if(e.value){var t=e.value,a=this.handleBlocksSort(t.blocks)||[];this.setState({blocks:a})}}},{key:"triggerChange",value:function(e){var t=this.props.onChange;t&&t((0,m.default)({blocks:this.state.blocks},e))}},{key:"hide",value:function(){this.setState({visible:!1})}},{key:"move",value:function(e,t){var a=this.state.blocks;if(!("up"==t&&0==e||"down"==t&&e==a.length-1)){"up"==t&&(e-=1);for(var l=0,n=a.length;l<n;l++)if(a[l].sort==e){var r=(0,m.default)({},a[l]),i=(0,m.default)({},a[l+1]);a[l]=(0,m.default)({},i,{sort:r.sort}),a[l+1]=(0,m.default)({},r,{sort:i.sort});break}this.setState({blocks:a}),this.triggerChange({blocks:a})}}},{key:"render",value:function(){var e=this,t=this.state,a=t.blocks,l=void 0===a?[]:a,n=t.visible,r=this.props.template,m=r.loading,h=r.dataSource,v=r.pagination,g=l.map(function(t,a){return C.default.createElement("div",{key:a,className:"blocks-item"},C.default.createElement(c.default,{type:"flex",justify:"space-between",align:"top"},C.default.createElement(f.default,{span:18},C.default.createElement(p.default,{className:"template-btn",type:"primary",onClick:e.show.bind(e,a)},"对应模版"),e.getTemplateName(t,a))),C.default.createElement(c.default,{style:{marginBottom:"10px"}},"区块标签：",t.tag),C.default.createElement(c.default,{gutter:16},C.default.createElement(f.default,{span:7},C.default.createElement(s.default,{className:"template-input",value:t.name,placeholder:"请输入区块名称",onChange:function(t){return e.handleInputChange(t,a,"name")}})),C.default.createElement(f.default,{span:7},C.default.createElement(s.default,{className:"template-input",value:t.description,placeholder:"请输入区块描述",onChange:function(t){return e.handleInputChange(t,a,"description")}})),C.default.createElement(f.default,{span:5},C.default.createElement(o.default,{title:"删除",placement:"top"},C.default.createElement(d.default,{className:"del-btn",type:"minus-circle-o",onClick:function(){return e.remove(t)}})),0!=a&&C.default.createElement(o.default,{title:"向上移动",placement:"top"},C.default.createElement(d.default,{type:"up-circle-o",disabled:0==a,onClick:function(){return e.move(t.sort,"up")}})),a+1!=l.length&&C.default.createElement(o.default,{title:"向下移动",placement:"top"},C.default.createElement(d.default,{type:"down-circle-o",disabled:a==l.length-1,onClick:function(){return e.move(t.sort,"down")}})))))}),b={title:"",visible:n,width:"80%",footer:null,onCancel:this.hide.bind(this)};return C.default.createElement("div",null,C.default.createElement(i.default,b,C.default.createElement(u.default,{simple:!0,size:"middle",columns:this.getColumns(),dataSource:(0,w.toJS)(h),pagination:v,onChange:this.onPageChange,loading:m,rowKey:function(e){return e.id}})),C.default.createElement(f.default,{offset:5,span:18},C.default.createElement(E.default,{defaultActiveKey:["block"]},C.default.createElement(_,{key:"block",header:"区块"},g,C.default.createElement("div",null,C.default.createElement(p.default,{type:"dashed",onClick:this.add.bind(this)},C.default.createElement(d.default,{type:"plus"})," 添加区块"))))))}}]),t}(y.Component),r=function(){var e=this;this.handleBlocksSort=function(e){if(!e)return!1;for(var t=[],a=0;a<e.length;a++)for(var l=0;l<e.length;l++)e[l].sort==a&&t.push(e[l]);return t},this.getColumns=function(){return[{title:"模版名称",dataIndex:"name",width:100},{title:"模版描述",dataIndex:"description",width:100},{title:"模版路径",dataIndex:"ftlPath",width:100},{title:"操作",width:100,className:"action",render:function(t,a){var l=a.id;return[C.default.createElement("a",{key:"action-1",onClick:e.onSelect.bind(e,l,a),style:{marginRight:"5px"}},"选择")]}}]},this.onSelect=function(t,a){var l=e.state.blocks,n=e.state.currentBlkIndex;l.map(function(e,l){l===n&&(e.blockTemplateId=t,e.blockTemplateName=a.name,e.blockTemplateUrl=a.ftlPath)}),e.setState({blocks:l,visible:!1}),e.triggerChange({blocks:l})},this.handleInputChange=function(t,a,l){var n=t.target.value,r=e.state.blocks;r.map(function(e){e.sort==a&&(e[l]=n)}),e.setState({blocks:r}),e.triggerChange({blocks:r})},this.onDeleteTemplate=function(t){var a=e.state.blocks;a.map(function(e,a){a===t&&(e.blockTemplateId=null,e.blockTemplateName="")}),e.setState({blocks:a}),e.triggerChange({blocks:a})},this.add=function(){var t=e.state.blocks;t.map(function(e,t){e.sort=t}),t.push({sort:t.length,name:"",description:"",blockTemplateId:null}),e.setState({blocks:t}),e.triggerChange({blocks:t})},this.show=function(t){e.setState({visible:!0,currentBlkIndex:t})},this.remove=function(t){var a=e.props.template.deleteBlock,l=e.state.blocks.filter(function(e){return e.sort!==t.sort});l.map(function(e,t){e.sort=t}),t.id&&a(t.id),e.setState({blocks:l}),e.triggerChange({blocks:l})},this.getTemplateName=function(t,a){return t.blockTemplateName?C.default.createElement("span",{style:{marginLeft:"10px"}},t.blockTemplateName," ",t.blockTemplateUrl,C.default.createElement(d.default,{className:"template-delete",type:"close",onClick:e.onDeleteTemplate.bind(e,a)})):null},this.onPageChange=function(t){var a=e.props,l=a.siteId;(0,a.template.getTemplateList)({siteId:l,pageNumber:t.current,pageSize:t.pageSize})}},l=n))||l)||l;t.default=x},clk9:function(e,t){},fZjL:function(e,t,a){e.exports={default:a("jFbC"),__esModule:!0}},fpag:function(e,t){},jFbC:function(e,t,a){a("Cdx3"),e.exports=a("FeBl").Object.keys},kE6k:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,n=C(a("rpsp")),r=C(a("vgHw")),i=C(a("0b0c")),u=C(a("IidI")),o=C(a("G3dI")),d=C(a("uuhB")),s=C(a("Dd8w")),c=C(a("1cZb")),f=C(a("Zx67")),p=C(a("Zrlr")),m=C(a("wxAW")),h=C(a("zwoO")),v=C(a("Pf15")),g=C(a("NJOH")),b=C(a("37+n"));a("Nmhe"),a("ZJow"),a("kxBb"),a("1uA9"),a("/Hhv"),a("TZP0"),a("YaoS"),a("mKHw"),a("8QNH");var k=C(a("GiK3")),E=a("F8kA"),y=a("Mn8c");a("y986");function C(e){return e&&e.__esModule?e:{default:e}}var S=b.default.Item,w=g.default.Option,I=(0,y.inject)("app")(l=(0,y.inject)("template")(l=(0,y.observer)(l=function(e){function t(e){(0,p.default)(this,t);var a=(0,h.default)(this,(t.__proto__||(0,f.default)(t)).call(this,e));return a.onCreate=function(){a.props.history.push("/template/edit")},a.onUploaderChange=function(e){var t=a.props,l=t.template.getTemplateList,n=t.app.selectSiteId,r=e.file.status;"done"===r?(c.default.success(e.file.name+" 导入成功."),l({siteId:n})):"error"===r&&c.default.error(e.file.name+" 导入失败.")},a.onSearch=function(){var e=a.props,t=e.form,l=t.getFieldsValue,n=(t.resetFields,e.template),r=n.getTemplateList,i=n.query,u=(0,s.default)({},i,l());for(var o in u)u[o]||delete u[o];u.pageNumber=1,r((0,s.default)({},u))},a.onReset=function(){var e=a.props,t=e.form,l=(t.getFieldsValue,t.resetFields),n=e.template,r=n.getTemplateList,i=n.query;l(),delete i.name,r((0,s.default)({},i,{pageNumber:1}))},a.onTypeChange=function(e){var t=a.props,l=t.template,n=l.getTemplateList,r=l.query,i=t.form.getFieldsValue,u=(0,s.default)({},r,i(),{type:e});for(var o in u)u[o]||delete u[o];u.pageNumber=1,n((0,s.default)({},u))},a}return(0,v.default)(t,e),(0,m.default)(t,[{key:"render",value:function(){var e=this.props,t=e.app.selectSiteId,a=e.template.query,l=e.form.getFieldDecorator,c={name:"file",multiple:!0,accept:"application/x-zip-compressed",showUploadList:!1,data:{siteId:t},onChange:this.onUploaderChange,action:"/auth/import/template"};return k.default.createElement("div",null,k.default.createElement(i.default,{gutter:8},k.default.createElement(o.default,{span:8},k.default.createElement(S,(0,s.default)({label:"模版名称"},{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}),l("name",{initialValue:a.name||""})(k.default.createElement(d.default,null)))),k.default.createElement(o.default,{span:4},k.default.createElement(S,(0,s.default)({label:"模板类型"},{labelCol:{span:10},wrapperCol:{span:14}}),l("type",{initialValue:a.type||""})(k.default.createElement(g.default,{onChange:this.onTypeChange},k.default.createElement(w,{value:""},"全部"),k.default.createElement(w,{value:"category"},"频道"),k.default.createElement(w,{value:"block"},"区块"),k.default.createElement(w,{value:"detail"},"详情"))))),k.default.createElement(o.default,{span:8},k.default.createElement(S,null,k.default.createElement(u.default,{type:"primary",onClick:this.onSearch},"查询"),k.default.createElement(u.default,{style:{marginLeft:"10px"},onClick:this.onReset},"重置")))),k.default.createElement(i.default,null,k.default.createElement(o.default,{span:8,style:{marginTop:"4px"}},k.default.createElement(u.default,{type:"primary",onClick:this.onCreate,style:{marginBottom:"20px"}},"新建模版"),k.default.createElement(n.default,c,k.default.createElement(u.default,{type:"primary",style:{marginBottom:"20px",marginLeft:"20px"}},k.default.createElement(r.default,{type:"upload"}),"导入模版")))),k.default.createElement(i.default,null,k.default.createElement("p",{style:{marginTop:"-10px",color:"grey",marginBottom:"20px",marginLeft:"90px"}},"(仅支持上传.zip格式文件)")))}}]),t}(k.default.Component))||l)||l)||l;t.default=(0,E.withRouter)(b.default.create()(I))},mvHQ:function(e,t,a){e.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(e,t,a){var l=a("FeBl"),n=l.JSON||(l.JSON={stringify:JSON.stringify});e.exports=function(e){return n.stringify.apply(n,arguments)}},rttv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,n=E(a("yF52")),r=E(a("Dd8w")),i=E(a("LoBt")),u=E(a("1cZb")),o=E(a("Zx67")),d=E(a("Zrlr")),s=E(a("wxAW")),c=E(a("zwoO")),f=E(a("Pf15"));a("tNTX"),a("/eDY"),a("YaoS");var p=a("GiK3"),m=E(p),h=a("F8kA"),v=a("Mn8c"),g=a("y986"),b=E(a("mw3O")),k=E(a("kE6k"));function E(e){return e&&e.__esModule?e:{default:e}}var y=(0,v.inject)("app")(l=(0,v.inject)("template")(l=(0,v.observer)(l=function(e){function t(e){(0,d.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));a.onEdit=function(e){a.props.history.push({pathname:"/template/edit",search:"?"+b.default.stringify({id:e})})},a.onDelete=function(e){var t=a.props.template,l=t.deleteTemp,n=t.getTemplateList,r=t.query;a.loading=!0;l(e,function(){u.default.success("删除成功",.6);var e=(0,g.toJS)(r);n(e)})},a.getColumns=function(){return[{title:"模版名称",dataIndex:"name",width:100},{title:"模版类型",dataIndex:"type",width:100,render:function(e,t){return"category"==e?"频道":"block"==e?"区块":"detail"==e?"详情":void 0}},{title:"模版描述",dataIndex:"description",width:100},{title:"模版路径",dataIndex:"ftlPath",width:100},{title:"操作",width:100,className:"action",render:function(e,t){var l=t.id;return[m.default.createElement("a",{key:"action-1",onClick:a.onEdit.bind(a,l),style:{marginRight:"5px"}},"编辑"),m.default.createElement(i.default,{key:"action-2",title:"确定删除吗",onConfirm:a.onDelete.bind(a,l)},m.default.createElement("a",null,"删除"))]}}]},a.onPageChange=function(e){var t=a.props.template,l=(t.pagination,t.getTemplateList),n=t.query;l((0,r.default)({},n,{siteId:a.selectSiteId,pageNumber:e.current,pageSize:e.pageSize}))};var l=e.template,n=e.app,s=n.selectSiteId;n.sites;return a.selectSiteId=s,l.getTemplateList({siteId:s}),a}return(0,f.default)(t,e),(0,s.default)(t,[{key:"componentWillReact",value:function(){var e=this.props,t=e.app,a=t.selectSiteId,l=(t.sites,e.template);this.selectSiteId!=a&&l.getTemplateList({siteId:a}),this.selectSiteId=a}},{key:"render",value:function(){var e=this.props.template,t=e.loading,a=e.dataSource,l=e.pagination;return m.default.createElement("div",null,m.default.createElement(k.default,null),m.default.createElement(n.default,{bordered:!0,columns:this.getColumns(),rowKey:function(e){return e.id},dataSource:(0,g.toJS)(a),pagination:l,onChange:this.onPageChange,loading:t}))}}]),t}(p.Component))||l)||l)||l;t.default=(0,h.withRouter)(y)}});